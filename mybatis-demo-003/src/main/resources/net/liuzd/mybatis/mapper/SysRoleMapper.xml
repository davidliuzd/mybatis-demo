<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.liuzd.mybatis.mapper.SysRoleMapper">
	<resultMap id="BaseResultMap"
		type="net.liuzd.mybatis.model.SysRole">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<id column="id" jdbcType="BIGINT" property="id" />
		<result column="role_name" jdbcType="VARCHAR"
			property="roleName" />
		<result column="enabled" jdbcType="BIT" property="enabled" />
		<result column="create_by" jdbcType="VARCHAR"
			property="createBy" />
		<result column="create_time" jdbcType="TIMESTAMP"
			property="createTime" />
	</resultMap>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		delete from sys_role
		where id = #{id,jdbcType=BIGINT}
	</delete>
	<insert id="insert"
		parameterType="net.liuzd.mybatis.model.SysRole">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into sys_role (id, role_name, enabled,
		create_by, create_time)
		values (#{id,jdbcType=BIGINT}, #{roleName,jdbcType=VARCHAR},
		#{enabled,jdbcType=BIT},
		#{createBy,jdbcType=VARCHAR}, #{createTime,jdbcType=TIMESTAMP})
	</insert>
	<update id="updateByPrimaryKey"
		parameterType="net.liuzd.mybatis.model.SysRole">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update sys_role
		set role_name = #{roleName,jdbcType=VARCHAR},
		enabled = #{enabled,jdbcType=BIT},
		create_by = #{createBy,jdbcType=VARCHAR},
		create_time = #{createTime,jdbcType=TIMESTAMP}
		where id = #{id,jdbcType=BIGINT}
	</update>
	<select id="selectByPrimaryKey" parameterType="java.lang.Long"
		resultMap="BaseResultMap">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select id, role_name, enabled, create_by, create_time
		from sys_role
		where id = #{id,jdbcType=BIGINT}
	</select>
	<select id="selectAll" resultMap="BaseResultMap">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select id, role_name, enabled, create_by, create_time
		from sys_role
	</select>

	<select id="selectRolesByUserId"
		resultType="net.liuzd.mybatis.model.SysRole">
		SELECT r.id,
		r.role_name roleName,
		r.enabled,
		r.create_by createBy,
		r.create_time createTime
		FROM sys_user u
		INNER JOIN sys_user_role ur ON u.id = ur.user_id
		INNER JOIN sys_role r ON ur.role_id = r.id
		WHERE u.id = #{userId}
	</select>
	
	<select id="selectRoleUsersByUserId" resultType="net.liuzd.mybatis.model.SysRoleExtend">
	    SELECT r.id,
	           r.role_name   roleName,
	           r.enabled,
	           r.create_by   createBy,
	           r.create_time createTime,
	           u.user_name   "sysUser.userName",
	           u.user_email   "sysUser.userEmail"
	    FROM sys_user u
	    INNER JOIN sys_user_role ur ON u.id = ur.user_id
	    INNER JOIN sys_role r ON ur.role_id = r.id
	    WHERE u.id = #{userId}
	</select>
	
	<select id="selectRolesByUserIdAndRoleEnabled" resultType="net.liuzd.mybatis.model.SysRole">
	    SELECT r.id,
	           r.role_name   roleName,
	           r.enabled,
	           r.create_by   createBy,
	           r.create_time createTime
	    FROM sys_user u
	    INNER JOIN sys_user_role ur ON u.id = ur.user_id
	    INNER JOIN sys_role r ON ur.role_id = r.id
	    WHERE 
	    	  u.id = #{userId} AND r.enabled = #{enabled} 
	    	<!--不使用注解：@Param，可用以下二种方式，只是不友好 Available parameters are [arg1, arg0, param1, param2] -->
	    	<!-- u.id = #{arg0} AND r.enabled = #{arg1}	    	 -->
	    	 <!-- u.id = #{param1} AND r.enabled = #{param2}	    	  -->	    	
	</select>
	
	<select id="selectRolesByUserAndRole" resultType="net.liuzd.mybatis.model.SysRole">
	    SELECT r.id,
	    r.role_name   roleName,
	    r.enabled,
	    r.create_by   createBy,
	    r.create_time createTime
	    FROM sys_user u
	    INNER JOIN sys_user_role ur ON u.id = ur.user_id
	    INNER JOIN sys_role r ON ur.role_id = r.id
	    WHERE u.id = #{user.id} AND r.enabled = #{role.enabled}
</select>
	
</mapper>